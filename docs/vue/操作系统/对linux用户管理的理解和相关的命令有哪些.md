## 一、是什么

linux是个多用户的系统，允许使用者在系统上通过规划不同类型、不同层级的用户，并公平地分配系统资源与工作环境。

而与windows系统最大的不同，linux允许不同的用户同时登录主机，同时使用主机的资源。

既然是多用户的系统，那么最常见的问题就是权限，不同的用户对于不同的文件都应该有各自的权限。

例如，小A希望个人文件不被其他用户读取，而如果不对文件进行权限设置，共享了主机资源的小B也可以读取小A的个人文件，这是不合理的。

这里面涉及到用户与用户组的概念。

## 二、用户与用户组

linux以“用户与用户组”的概念，建立用户与文件权限之间的联系，保证系统能够充分考虑每个用户的隐私保护，很大程度上保障了linux作为多用户系统的可行性。

从文件权限的角度出发，“用户与用户组”引申为三个具体的对象：

- 文件所有者

- 用户组成员

- 其他人

每个对象对某一个文件的持有权限是不同的。

**文件所有者**

当一个用户创建了一个文件，这个用户就是这个文件的文件所有者。文件所有者对文件拥有最高权限，同时排他性得拥有该文件。

除非文件所有者开放权限，否则其他人无法对文件执行查看、修改等操作。

**用户组**

将“其他用户”区分为用户组成员和其他人后，若文件所有者希望对部分用户开放权限，而对其他人继续保持私有，则只需要将这部分用户与文件所有者划入一个用户组。

这样，这部分用户就成了与文件所有者同组的用户组成员。用户可以对用户组成员开放文件权限，用户组成员则具备了查看、修改文件的权限，而对其他无关用户保持私有。

例如，团队成员之间保持文件资源共享，但对非团队成员保持私有，这就需要将文件所有者与团队成员用户划分为同一个用户组，再对用户组成员开放权限即可。

**其他人**

既与文件所有者没有任何联系的其他用户。

**小结**

户与用户组的对应关系是：一对一，多对一、一对多或多对多；

- 一对一：某个用户可以是某个组的唯一成员。

- 多对一： 多个用户可以是某个唯一的组的成员，不归属其他用户组。

- 一对多：某个用户可以是多个用户组的成员。

- 多对多：多个用户对应多个用户组，并且几个用户可以是归属相同的组。

**拓展**

当我们使用`ls -l`的时候，会列出当前目录的文件信息，如下：

```js
drwxr-xr-x 3 osmond osmond 4096 05-16 13:32 nobp
```

- d：文件类型

- rwxr-xr-x：文件权限

- 3 硬链接数或目录包含的文件数。

- osmond: 文件所有者。

- 4096：文件长度。

- 05-16 13:32: 文件上次修改的事件和日期。

- nobp：文件名。

下面主要看看文件权限分析，实际上是由9个字符组成，每3个一组：

- 第一组：文件所有者的权限
- 第二组：与文件所有者同组的用户的权限
- 第三组：其他人（other）的权限

- 代表当前没有，rwx对应代表的意思是：r 可读，w 可写，x 执行。

## 三、用户操作

用户相关的操作有如下：

- 添加用户

useradd 可以用来创建新用户，简要语法为：

```js
useradd [options] [username]
```
例如：

添加一个一般用户

```js
# useradd kk // 添加用户kk
```

为添加的用户指定相应的用户组。

```js
# useradd -g root kk // 添加用户kk，并指定用户所在的组委root用户组
```

创建一个系统用户

```js
# useradd -r kk // 创建一个系统用户kk
```

为新添加的用户指定/home目录

```js
# useradd -d /home/myf kk // 新添加 用户kk，其home目录为/home/myf

// 当用户名kk登录主机时，系统进入的默认目录为  /home/myf
```

**设置密码**
创建的用户还没有设置登录密码，需要利用`passwd`进行密码设置

```js
asswd [options] [username]
```
option 参数有如下：

- -d删除密码

- -f强迫用户下次登录时必须修改口令

- -w口令要到期提前警告的天数

- -k更新只能发送在过期之后

- -l停止账号使用

- -S 显示密码信息

- -u 启用已被停止的账户

- -x 指定口令最长存活期。

- -g 修改群组密码

- 指令口令最短存活期

- -i 口令过期后多少天禁用该用户

例如，修改用户密码

```js
# passwd runoob // 设置runoob用户的密码

Enter new UNIX password: // 输入新密码，输入的密码无回显

Retype new UNIX password: // 再次输入新密码，输入的密码无回显

passwd: password updated successfully // 密码修改成功

#
```

显示账号密码信息

```js
# passwd -S runoob // 显示用户runoob的密码信息

runoob P 05/13/2010 0 99999 7 -1
```
删除用户密码
```js
# passwd -d runoob // 删除用户runoob的密码
password: password expiry information changed.
```

**修改用户**

`change`命令用来修改与用户密码相关的过期信息，如密码失效日、密码最短保留天数、失效前警告天数等。
```js
change [options] [username]
```
常见的参数有：

- -d：指定密码最后修改日期。

- -E：密码到期的日期。

- -l：列出用户以及密码的有效期。

- -m：密码能够更改的最小天数。

- -M：密码保持有效的最大天数。

**删除用户**

userdel 命令用来删除用户的相关的所有数据。

```js
userdel [options] [username]
```
常见的参数有：

- -r：删除用户登入目录以及目录中所有文件。

例如删除用户账号
```js
# userdel hnlinux
```
用户组相关的操作如下：

- -g：指定新建工作组的id；

- -r：创建系统工作组，系统工作组的组id小于500。

- -K：覆盖配置文件“/ect/login.defs”

- -o：允许添加组ID号不唯一的工作组。

- -f，--force：如果指定的组已经存在，此选项将强制删除它，并且不提示确认。

例如创建一个新的组，并添加组ID。
```js
# groupadd -g 344 hnlinux
```
**修改用户**

groupmod 命令用来修改 group 相关的参数，例如群组识别码或者名称。
```js
groupmod [options] [groupname]
```
常见的参数有：

- -g<群组识别码> 设置欲使用的群组识别码

- -o 重复使用群组识别码

- -n <新群组名称> 设置欲使用的新组名

例如修改组名：
```js
# groupmod -n linux linuxso
```
**删除用户组**

groupdel 命令用来删除用户组。如果该群组中仍包括某些用户，则必须先删除这些用户后，方能删除群组。
```js
groupdel [groupname]
```
日常工作通常会碰到只有`root`用户才有权限执行的操作，这就需要使用用户身份切换的命令：

**su**

用于变更为其他使用者的身份，除root外，需要键入该使用者的密码。

**sudo**

sudo 命令以系统管理者的身份执行指令，也就是说，经由 sudo 所执行的指令就好像是root亲自执行。

不是所有的用户都能执行 sudo 命令的，而是在 /etc/sudoers 文件内的用户才能执行这个命令。

例如 sudo 命令使用 ls：
```js
$ sudo ls
```